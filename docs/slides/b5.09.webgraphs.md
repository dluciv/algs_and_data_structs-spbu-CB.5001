<span id="slides-title" hidden>Вебграфы</span>

## О чём пойдёт речь

* Понятие вебграфа
* Комбинаторные модели
    * Барабаши-Альберт
    * Боллобаша–Риордана
    * Бакли-Остгуса
    * Копирования
    * Примеры
* Модели блуждания
    * Google matrix
    * Pregel
    * Примеры

= = = = = =

# Понятие вебграфа и его количественные модели

- - - - - -

## Понятие

**Вебграф** — ориентированный мультиграф, узлы которого соответствуют сущностям, а дуги — ссылкам.

Допускаются петли, кратные рёбра и т.д.

@pause@

При этом сущности можно рассматривать разные:

* страницы
* сайты (например, факторизовать по домену)
* аккаунты одного пользователя

= = = = = =

# Комбинаторные модели

- - - - - -

## Работы Барабаши и Альберт

Эмпирические исследования конца XX века

* Вебграфы *безмасштабны*,
  т.е. вероятность, что степень произвольной вершины равна $k$, близка $\operatorname{P}(k) \approx C\ k^\boldsymbol{-\gamma}$ (безмасштабность — [потому что экспоненциальные закономерности одинаково выглядят во всех масштабах](https://mathinsight.org/scale_free_network)); $\gamma\approx 2{,}1 \Rightarrow C \approx 0{,}64$
  * Barabási A. L., Albert R. [Emergence of scaling in random networks](https://arxiv.org/pdf/cond-mat/9910332.pdf%3Forigin%3Dpublication_detail) // Science. – 1999. – Т. 286. – №. 5439. – С. 509-512.
  * Привычная «маркетинговая» формулировка — 80% чего-то сконцентрировано в 20% чего-то (принцип Парето)
* Количество дуг растёт линейно (не квадратично)
* Диаметр графа небольшой (19 «рукопожатий» в 1999) — Albert R., Jeong H., Barabási A. L. [Diameter of the world-wide web](https://arxiv.org/pdf/cond-mat/9907038.pdf) // Nature. – 1999. – Т. 401. – №. 6749. – С. 130-131.

- - - - - -

## Барабаши и Альберт о построении веба

Новый сайт при появлении ставит фиксированное количество ссылок на существующие пропорционально их
популярности.

$$\operatorname{P}(n\rightarrow i) = \frac{\operatorname{deg}(i)}{\sum_j{\operatorname{deg}(j)}}$$

**Модели предпочтительного присоединения** — мат. модели получающихся таким образом случайных графов

@pause@

Проблема модели в том, что она достаточно грубая: даёт вероятность для одной (первой) ссылки, но уже после её добавления становится некорректной. Есть модели, аналогичные этой, по-разному пытающиеся учитывать то, как связаны ссылки.

- - - - - -

## Модель Боллобаша и Риордана (1)

«Симуляция»

1. Добавляем $m=1$ ссылку. Последовательность графов $G_1^n$.

  * $G_1^1$ (ссылка на себя, больше не накого)
  * ...
  * $G_1^{n-1}$ — $n-1$ вершин
  * $G_1^n$
    * $\operatorname{P}(n\rightarrow n) = \frac{1}{2n-1}$ — ссылка на себя
    * $\operatorname{P}(n\rightarrow i \neq n) = \frac{\operatorname{deg}(i)}{2n-1}$ — ссылка ещё на кого-то
    * $2n-1$ — сумма степеней вершин в этом *дереве*, чтобы $\sum \operatorname{P} = 1$

2. Добавляем $m>1$ ссылок.

  * Пусть $G_1^{mn}$ — случайный граф, получившийся в рамках процесса выше с $mn$ вершинами.
  * Разобьём эти вершины на $1\ldots m, m+1\ldots2m,\ldots$ и эти $n$ кусков объявим вершинами $V_1, \ldots V_n$. Рёбра сохраняем. Петли будут. И вот это и есть $G_m^n$.

- - - - - -

## Модель Боллобаша и Риордана (2)

Построение из случайного хордового графа

### $m = 1$

1. Берём точки от $1$ до $2n$
2. Выбираем из них случайные пары. Это можно сделать $\frac{(2n)!}{2^{n}\ (n)!}$ способами
3. Идём от $1$ до $n$
  * Встретили левый конец дуги — запомнили вершину во временном списке
  * Встретили правый — опустошили список, объединив вершины в $V_1$
  * Потом так же в $V_2$ и т.д.

### $m > 1$

Так же, как и раньше, склейкой

- - - - - -

## Модель Боллобаша и Риордана (3)

Получающийся граф по свойствам ближе к эмпирическим наблюдениям, особенно для больших вебграфов. А ведь уже не конец XX века!

@pause@

Но соответствует $\gamma = 3$, т.е. искажает распределение степеней вершин.

Можно доказать справедливость оценок:

@pause@

если $\\#\_m^n(d)$ — кол-во вершин степени $d$ в $G_m^n$, то

$$\forall m>1, \varepsilon >0 \ \ \operatorname{P}\left(  (1-\varepsilon)\alpha_{m,d} \le \frac{\\#\_m^n (d)}{n} \le  (1+\varepsilon)\alpha_{m,d} \right)  \overset{n\rightarrow\infty}{\rightarrow} 1,$$

Где $$\alpha_{m,d} = \frac{2m(m+1)}{(d+m)(d+m+1)(d+m+2)}$$

- - - - - -

## Модель Боллобаша и Риордана (4)

**Теорема Боллобаша-Риордана**

$$\forall m>1, \varepsilon >0 \ \ \operatorname{P}\left(  (1-\varepsilon)\frac{\ln n}{\ln\ln n} \le \operatorname{diam}(G_m^n) \le  (1+\varepsilon)\frac{\ln n}{\ln\ln n} \right) \overset{n\rightarrow\infty}{\rightarrow} 1$$

**Теорема Гречникова**

$$\operatorname{E}(\\#\_m^n (d)) = \operatorname{I}\\{d > 0\\} \frac{(2mn+1)(m+1)}{(d+m)(d+m+1)(d+m+2)} - \frac{\operatorname{I}\\{d = 0\\}}{m} + \mathcal{O}_m\left( \frac{d}{n} \right)$$

- - - - - -

## Модель Бакли-Остгуса

Модифицирует способ построения графа Боллообаша-Риордана для того, позволяя управлять параметром $\gamma$.

$\alpha_{m,d}$ дополнительно параметризуется и становится $\alpha_{а,m,d}$, что в итоге позволяет добиться

$$\frac{\\#\_{a,m}^{n}(d)}{n} = \mathcal{O}\left( d^{-a-2} \right)$$

* при $a = 1$ получается $\gamma = 3$ — как у Боллобаша и Риордана
* при $a = 0{,}1$ получается $\gamma = 2{,}1$ — как у Барабаши и Альберт

Но Бакли и Остгус доказали только для целых $a$

Buckley P. G., Osthus D. [Popularity based random graph models leading to a scale-free degree sequence](https://www.sciencedirect.com/science/article/pii/S0012365X03006940) // Discrete Mathematics. – 2004. – Т. 282. – №. 1-3. – С. 53-68.

- - - - - -

## Модель Бакли-Остгуса и снова Гречников

Гречников:

1. Доказал для произвольных $a$

$$\operatorname{E}(\\#\_{a,m}^n (d)) = n\frac{ B(d + ma, a + 2)}{ B(ma, a+1)} + \mathcal{O}_{a,m}\left(\frac{1}{d}\right),$$

где $ B (x,y)=\frac{\Gamma(x) \Gamma(y)}{\Gamma(x+y)}$

2. Кроме математического ожидания оценил дисперсии и т.д.

- - - - - -

## Модель копирования

Параметризована $\alpha \in (0, 1)$.

* Вначале $n \ge 2$, и есть $G_{m,\alpha}^n$
* Добавляем к нему $n$-ю вершину с $m$ исходящими рёбрами (без самоссылок)
  * Выбираем случайную вершину $p$ из $1,\ldots,n-1$ (каждая с вероятностью $\frac{1}{n-1}$). Это старый сайт, интересный автору нового, с которого он иногда будет копировать ссылки
  * Бросаем «кривую» монетку, $\alpha$ — орёл, $1-\alpha$ — решка
    * Решка — копируем самую популярную ссылку с сайта
    * Орёл — случайно выбираем сайт из $1,\ldots,n-1$
    * Повторяем $m$ раз

@pause@

Для такого графа можно покаазать, что

$$\\#\_m^n (d) = \operatorname{const}(m, \alpha) / \left( d^{\frac{2-\alpha}{1-\alpha}} \right)$$

Kumar R., Raghavan P., Rajagopalan S.,Sivakumar D., Tomkins A., Upfal E. [Stochastic models for the web graph](https://web.archive.org/web/20201204214500/https://www.researchgate.net/profile/Eli_Upfal/publication/2488249_Stochastic_Models_for_the_Web_Graph/links/0deec5208d76e5a5d5000000/Stochastic-Models-for-the-Web-Graph.pdf) // Proc. 41st Symposiumon Foundations of Computer Science. — 2000

- - - - - -

## Пример: Борьба со [ссылочными фермами](https://en.wikipedia.org/wiki/Link_farm)

Ссылочная ферма — группа сайтов, намеренно активно ссылающихся друг на друга (но обычно не полный граф, чтобы было тяжелее отловить). Продаёт ссылки со своих сайтов желаюим подняться в поисковых выдачах.

@pause@

Помним, что граф очень большой. Т.е. алгоритмы анализа должны быть, желательно, не очень вычислительно сложными.

@pause@

Алгоритм подозревает ссылочную ферму и покупателя. Кроме того, для вершин со степенями $d_1$ и $d_2$ есть оценки (их обычно не публикуют, тайна =)) количества ссылок между ними. И система ранжирования выдачи может реагировать на его нарушение.

- - - - - -

## Более общо: зачем это?

* Нахождение закономерностей для моделей построения вебграфов
* Построения на основе этих закономерностей (например, оценка диаметра)
* Выявление аномалий (например, поиск ферм)

Поскольку графы большие, эта математика, хоть и «дорогая», но очень «выгодная»: она позволяет меньше моделировать и больше выводить аналитически

@pause@

Даже приведённые такие достаточно тонкие модели берут $m$, как постоянный параметр

= = = = = =

# Модели блуждания

- - - - - -

## Google Matrix

$A$ — матрица смежности по ссылкам. $A_{i,j} = 1$ когда есть ссылка $j \rightarrow i$

$S$ — нормированная матрица в том смысле, что $\forall j$ её $j$-й столбец — это $j$-я столбец $A$, поделенный на $\Sigma_{i=1}^N A_{i,j}$

$$G_{ij} = \alpha S_{ij} + (1-\alpha) \frac{1}{N},$$

где $N$ вершин в вебграфе, $\alpha$ — коэфф. затухания при переходе по ссылкам

@pause@

[Немного детальнее и сложнее](http://www.scholarpedia.org/article/Google_matrix)

- - - - - -

## Пример: Page Rank

Page Rank — собственный ветор матрицы, соответствует ситуации, когда блуждание стабилизировалось

Можно вычислять, например, итеративно, начиная со случайного вектора $b_0$

$$b_{k+1} = \frac{Gb_k}{\|Gb_k\|}$$

- - - - - -

## Google Pregel

Потенциально даёт более гибкие модели.

Были и описание, и пример Page Rank.

= = = = = =

## Литература

* Bollobas B. Random Graphs  Cambridge University. Press, 2001. — 520 c.
* Райгородский А. М. [Модели случайных графов и их применения](https://cyberleninka.ru/article/n/modeli-sluchaynyh-grafov-i-ih-primeneniya) // Труды МФТИ. 2010. №4.
  * [Более популярно](https://elementy.ru/nauchno-populyarnaya_biblioteka/431792/Matematicheskie_modeli_interneta)
* Райгородский А. М. [Модели веб-графов и их приложения](https://www.lektorium.tv/course/22842) // CS-клуб ПОМИ РАН, 2013
* Гречников Е. А. [Арифметические свойства вторых степеней вершин случайного веб-графа в модели Боллобаша–Риордана](https://web.archive.org/web/20151025085220/https://mipt.ru/upload/b15/f_g56o-arphcxl1tgs.pdf) // ТРУДЫ МФТИ. – 2012. – Т. 4. – №. 1. – С. 51

= = = = = =

## Вопросы

* Опишите принипы модели Барабаши-Альберт
* Опишите принипы модели Боллобаша–Риордана
* Опишите принипы модели Бакли-Остгуса
* Опишите принипы модели копирования
* Опишите принципы Google Matrix

## Упражнения

* Численно проиммитируйте работу Google Matrix на простом искусственном примере
* Сгенерируйте любой достаточно большой граф по любой из предложенных моделей, проверьте справедливость оценок
