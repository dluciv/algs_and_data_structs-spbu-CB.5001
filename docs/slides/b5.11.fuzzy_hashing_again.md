<span id="slides-title" hidden>И снова нечёткое хэширование</span>

# О чём пойдёт речь

* Рандомизированные нечёткие хэш-функции
* Сравнение по значению нечётких хэш-функций
* Поиск похожих аргументов по значению нечётких хэш-функций

= = = = = =

# Рандомизированные нечёткие хэш-функциии

- - - - - -

## Вспомним «плохие» хэш-функции

II семестр, [хэш-функции и хэш-таблицы](https://dluciv.github.io/algs_and_data_structs-spbu-CB.5001/slides.html?md=08.hashtables#/2/1/1)

@pause@

«Плохие» функции не вызывают «лавинный» эффект, т.е. незначительное изменение аргумента не вызывает значительного изменения значения

- - - - - -

## Фильтр Блума

Проверяет, может ли элемент входить во множество. Допускает ложноположительные ответы.

* Множество представляется, как набор битов $\\{0, 1\\}^m$
* $h_1, \ldots, h_k: A \rightarrow I = \\{0, 1\\}^m$ — универсальные хэш-функции
* При добавлении элемента $x$ во множество выполняется побитовое *или*

$$S' = S \vee {\displaystyle \operatorname{\vee}_{i=1}^k}  h_i(x)$$

[Вероятность ложноположительного срабатывания](https://en.wikipedia.org/wiki/Bloom_filter#Probability_of_false_positives)

$$P = \left( 1-e^{-kn/m} \right)^k$$

Оптимальное $m$

$$k = \frac{m}{n} \ln 2$$

**Литература**

* B. H. Bloom. [Space/time trade-offs in hash coding with allowable errors](https://web.archive.org/web/20170809034527/http://www.cs.princeton.edu/courses/archive/spring05/cos598E/bib/p422-bloom.pdf). Commun. ACM 13, 7 (July 1970), 422–426.

- - - - - -

## Схожесть и различия

Мера схожести Жаккара

$$J(A'\subset A, A'' \subset A) = \frac{|A' \cap A''|}{|A' \cup A''|}$$

Расстояние Хэммминга

$$\operatorname{dist}_H (A', A'') = | A' \triangle A'' |$$

**Литература**

* Jaccard, Paul (1901), [Étude comparative de la distribution florale dans une portion des Alpes et des Jura](https://upload.wikimedia.org/wikipedia/commons/e/e0/%C3%89tude_comparative_de_la_distribution_florale_dans_une_portion_des_Alpes_et_du_Jura.pdf), Bulletin de la Société vaudoise des sciences naturelles, 37: 547–579 (фр.)
* R. W. Hamming, [Error detecting and error correcting codes](https://calhoun.nps.edu/bitstream/handle/10945/46756/Hamming_1982.pdf) in The Bell System Technical Journal, vol. 29, no. 2, pp. 147-160, April 1950

- - - - - -

## MinHash: хэш-функция

* $h \in H: A \rightarrow I$ — универсальная хэш-функция
* $h_{min}(A' \subset A) = \min_{a \in A'} h(a)$

$h_i \in H$ иногда определяются чере одну $h \in H$, как $h_i = h \circ \mathit{perm}_i: A \rightarrow I$

**Литература**

* A. Z. Broder. [On the resemblance and containment of documents](https://web.archive.org/web/20150131043133/http://gatekeeper.dec.com/ftp/pub/dec/SRC/publications/broder/positano-final-wpnums.pdf) // Proceedings. Compression and Complexity of SEQUENCES 1997, Salerno, Italy, 1997, pp. 21-29

- - - - - -

## MinHash: мера Жаккара

$$\operatorname{P}(\forall h \in H' \subset H\, h_{min}(A') = h_{min}(A'')) \overset{|H'|\rightarrow|H|}{\rightarrow} J(A', A'')$$

* Если при вычислении $J$ нас устраивает ошибка $\varepsilon$, достаточно взять $k = |H'| = \left\lceil\frac{1}{\varepsilon^2}\right\rceil$


- - - - - -

## SimHash: хэш-функция

Так же, как MinHash, но:

* Не минимум, а побитовое среднее
* Среднее округляется к ближайшему целому (0 или 1)

**Литература**

Charikar M. S. [Similarity estimation techniques from rounding algorithms](https://web.archive.org/web/20200709090229/https://www.cs.princeton.edu/courses/archive/spr04/cos598B/bib/CharikarEstim.pdf) // Proceedings of the thiry-fourth annual ACM symposium on Theory of computing. – 2002. – С. 380-388.

- - - - - -

## SimHash: расстояние Хэмминга

Между двумя аргумментами — очевидным образом это оно.

При усреднении можно [использовать веса различных по смыслу частей](https://web.archive.org/web/20200504085128/http://benwhitmore.altervista.org/simhash-and-solving-the-hamming-distance-problem-explained/)

- - - - - -

## Какая была идея?

* Миллион мартышек за миллион лет напечатают Войну и мир или Гамлета. Если не будут умничать, а будут вести себя статистически правильно.

@pause@

* Много бессмысленных хэш-функций, смогут «нащупать» особенности данных
  * Особенности будут бессмысленными, но значимыми, т.е. будут эти данные идентифицировать
  * И у нас уже был сходный пример с рандомизированными базисами

= = = = = =

# Сравнение и поиск похожих

- - - - - -

Пусть у нас $10^7$ документов. Для поиска похожих придётся сравнить $5\cdot 10^{13}$... Очевидно, лучше сравнивать хэши, а не документы



= = = = = =

## Вопросы

* Что такое коллизия хэш-функции?
* Что такое универсальная хэш-функция?
* Что такое совершенная хэш-функция?
* Опишите прнцип построение двухуровневой хэш-таблицы
* Зачем применяется двойное хэширование?
* Что такое блочный шифр?
* Что такое криптографическая функция сжатия?
* Опишите принципы построения функций класса Меркла-Дамгора, приведите примеры
* Опишите атаку удлиннением сообщения
* Опишите принципы построения функций класса Keccak, приведите примеры
* Опишите принципы построения функций класса SWIFFT
